<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="canonical" href="https://ufdl.cms.waikato.ac.nz/wai-annotations-manual/component_util/">
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Utility Components - wai-annotations manual</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Utility Components";
    var mkdocs_page_input_path = "component_util.md";
    var mkdocs_page_url = "/wai-annotations-manual/component_util/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> wai-annotations manual</a>
        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../install/">Installation</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../usage/">Usage</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Examples</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../examples_overview/">Overview</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../examples_formats/">Format conversions</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../examples_audio/">Audio processing</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../examples_imgaug/">Image dataset augmentation</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../examples_imgstats/">Image dataset statistics</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../examples_imgvis/">Image dataset visualizations</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../examples_video/">Video handling</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../examples_redis_predictions/">Predictions via Redis</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../examples_generic/">Generic plugin wrappers</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../docker/">Docker</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../architecture_overview/">Architecture overview</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../plugin/">Plugin guide</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../domains/">Domains</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../plugins/">Plugins</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../glossary/">Glossary</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">wai-annotations manual</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Utility Components</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h3 id="utility-components">Utility Components</h3>
<p>wai-annotations comes with some utility base-classes for common types of components, found in the
<code>wai.annotations.core.component.util</code> package. They are listed here.</p>
<h4 id="input">Input</h4>
<h5 id="localfilenamesource">LocalFilenameSource</h5>
<p>TODO</p>
<h5 id="annotationfileprocessor">AnnotationFileProcessor</h5>
<p>TODO</p>
<h4 id="output">Output</h4>
<h5 id="localfilewriter">LocalFileWriter</h5>
<p>TODO</p>
<h5 id="separatefilewriter">SeparateFileWriter</h5>
<p>TODO</p>
<h5 id="jsonfilewriter">JSONFileWriter</h5>
<p>TODO</p>
<h4 id="splitting">Splitting</h4>
<h5 id="splitsink">SplitSink</h5>
<p>Specialised sink component for handling splitting the stream of processed items among a group of splits. Takes 2
options: <code>--split-names</code>, followed by a name for each split; and <code>--split-ratios</code>, followed by an integer ratio of
how many items to add to each split. The sink component will then alternate which split it is acting on behalf of for
each item it receives. The alternation is designed so that at any stage, the ratio of items processed for each split is
as close as possible to the specified <code>--split-ratios</code>.</p>
<p>Sub-classes of <code>SplitSink</code> should implement the <code>consume_element_for_split</code>/<code>finish_split</code> methods, similar to an
ordinary sink component. During execution of either of these methods, the following information can be utilised:</p>
<ul>
<li><code>self.is_splitting</code>: whether the user specified any splits to perform.</li>
<li><code>self.split_label</code>: the label of the current split (specified by <code>--split-names</code>). This is <code>None</code> if splits weren't
  specified.</li>
</ul>
<p>The following sections detail additional functionality that can be added to split-sinks.</p>
<h5 id="splitstate">SplitState</h5>
<p>Specialised form of <a href="../stream/#ProcessState">process state</a> which manages separate state for each split. Accessing this
property will return a separate instance depending on which split the component is currently acting for.</p>
<h5 id="requiresnosplitfinalisation">RequiresNoSplitFinalisation</h5>
<p>Specialised form of <a href="../stream/#RequiresNoFinalisation">the RequiresNoFinalisation mixin</a>, which declares that the
split-sink doesn't need to perform any clean-up after all items have been processed. This automatically implements
<code>finish_split</code>.</p>
<h5 id="withpersistentsplitfiles">WithPersistentSplitFiles</h5>
<p>A mixin class for use with components which inherit from <code>SplitSink</code> and need to keep files open while writing them
across the splits. The <code>_init_split_files</code> method should be implemented to open all files needed by the sink, and return
them as some sort of collection. The <code>_iterate_split_files</code> should iterate over the collection returned by
<code>_init_split_files</code>. Components which implement this mixin can then access the <code>_split_files</code> property during
execution of their <code>consume_element_for_split</code>/<code>finish_split</code> methods to get access to the file-collection for the
current split.</p>
<h4 id="other">Other</h4>
<p>General-purpose utilities for components.</p>
<h5 id="buffer">Buffer</h5>
<p>This processor component buffers the entire stream, and passes it as a list to the next component in its <code>finish</code>
method.</p>
<h5 id="enumerator">Enumerator</h5>
<p>This processor component enumerates each item passed to it, forwarding a tuple of the 0-based index of the item and
the item itself.</p>
<h5 id="withrandomness">WithRandomness</h5>
<p>This is a mixin class which can be used with any component, and adds a <code>--seed</code> option for randomisation. The help-text
for the option can be specified. If the user sets a seed value, the <code>random</code> property will provide a <code>Random</code> instance
initialised with the provided seed. If the option was not set, <code>None</code> will be returned by the property.</p>
              
            </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
